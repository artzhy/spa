var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},spa;(function(n){var t=function(){function n(){this.size=ko.observable();this.title=ko.observable()}return n.prototype.close=function(){},n.prototype.show=function(){},n.prototype.dispose=function(){},n}(),i;n.DialogViewModel=t;i=function(n){function t(){n.apply(this,arguments);this.value=ko.observable()}return __extends(t,n),t.prototype.okClick=function(){this.close(this.value())},t.prototype.cancelClick=function(){this.close()},t}(t);n.InputNumberDialog=i})(spa||(spa={})),function(n){var t=function(){function t(){var n=this;this._activePageSubscriptions=[];this._cachedLayouts=[];this._cachedPages=[];this._started=!1;window.onpopstate=function(){n.onRouteChanged()};document.body.addEventListener("click",function(t){if(t.target&&t.target.tagName&&t.target.tagName=="A")return n.onAnchorClick(t)})}return t.prototype.start=function(){this._started=!0;this.onRouteChanged()},t.prototype.back=function(){history.back()},t.prototype.forward=function(){history.forward()},t.prototype.home=function(){this.navigate(this.homePage)},t.prototype.navigate=function(t,i){(this._activePage==null||this._activePage.canLeave())&&(history.pushState(null,document.title,"/"+t+i==null?"":"?"+n.QueryStringSerializer.serialize(i)),this.onRouteChanged())},t.prototype.navigateUrl=function(n){history.pushState(null,document.title,n);this.onRouteChanged()},t.prototype.onAnchorClick=function(n){var t=n.target,i=t.hasAttribute("href")?t.getAttribute("href"):null;if(i!=null&&i.length>0&&i!="#"&&t.target!="_blank")return this.navigateUrl(t.href),n.preventDefault(),n.stopPropagation(),!1},t.prototype.onRouteChanged=function(){if(this._started){n.Dialog.destroyAll();var t=this.removeTrailingSlashes(location.pathname),i=location.search!=null&&location.search.length>1?n.QueryStringSerializer.deserialize(location.search.substr(1)):null;isNullOrWhiteSpace(t)&&(t=this.homePage);this.onPageLoading(t,i)}},t.prototype.onPageLoading=function(t,i){var f=this,r={page:{name:t,params:i==null?null:JSON.parse(JSON.stringify(i))}},u=history.state,e;if(u==null&&(u=newGuid(),history.replaceState(u,document.title,location.pathname+location.search)),this.onpageloading!=null)this.onpageloading(r);if(e=r.page==null||r.page.name.toLowerCase()!=t.toLowerCase()||JSON.stringify(i)!=JSON.stringify(r.page.params),e){if(u=newGuid(),r.page==null){this.onPageLoadError(t,i,u,null,new n.Exception("Страница не найдена."));return}history.replaceState(u,document.title,this.getPageUrl(r.page.name,r.page.params))}this.resolveRoute(r.page.name,r.page.params,u,r.page.layoutName,function(n,t,i){if(i!=null)f.onPageLoadError(r.page.name,r.page.params,u,r.page.layoutName,i);else f.onPageLoaded(n,t)})},t.prototype.onPageLoaded=function(n,t){var i={page:{layoutName:t==null?null:t.name,name:n.name,params:n.params()}};if(this.onpageloaded!=null)this.onpageloaded(i);n.guid==history.state&&this.activatePage(n,t)},t.prototype.onPageLoadError=function(n,t,i,r,u){var f={exception:u,page:{layoutName:r,name:n,params:t}};if(this.onpageloaderror!=null)this.onpageloaderror(f);f.errorPage==null||isNullOrWhiteSpace(f.errorPage.name)?this.loadDefaultErrorPage(i,r,u):this.loadErrorPage(f.errorPage.name,f.errorPage.params,i,f.errorPage.layoutName)},t.prototype.loadPage=function(n,t,i,r){var u=this;this.resolveRoute(n,t,i,r,function(f,e,o){if(o==null)u.onPageLoaded(f,e);else u.onPageLoadError(n,t,i,r,o)})},t.prototype.loadErrorPage=function(n,t,i,r){var u=this;this.resolveRoute(n,t,i,r,function(n,t,f){if(f!=null)u.loadDefaultErrorPage(i,r,f);else u.onPageLoaded(n,t)})},t.prototype.loadDefaultErrorPage=function(t,i,r){var u=this,f=n.InternalServerErrorPage.pageName;r instanceof n.NotFoundException||r instanceof n.HttpException&&r.statusCode==404?f=n.NotFoundPage.pageName:(r instanceof n.ForbiddenException||r instanceof n.HttpException&&r.statusCode==403)&&(f=n.ForbiddenPage.pageName);this.resolvePage(f,{exception:r},t,function(n,t){if(t!=null){alert(r.toString());return}if(i!=null)u.resolveLayout(i,function(t,i){if(i!=null)u.onPageLoaded(n);else u.onPageLoaded(n,t)});else u.onPageLoaded(n)})},t.prototype.resolveRoute=function(n,t,i,r,u){var f=this;this.resolvePage(n,t,i,function(n,t){t!=null?u(null,null,t):r==null?u(n):f.resolveLayout(r,function(t,i){i!=null?u(null,null,i):u(n,t)})})},t.prototype.resolvePage=function(t,i,r,u){var e=this,f=this._cachedPages.filter(function(n){return n.guid==r})[0],o;if(f!=null){this._cachedPages.remove(f);this._cachedPages.push(f);u(f);return}if(o=n.pages.find(t),o==null){u(null,new n.NotFoundException("Страница '{0}' не найдена.".format(t)));return}new n.Page(o,i,function(n,t){if(t!=null){u(null,t);return}for(n.guid=r,e._cachedPages.push(n);e._cachedPages.length>10;)e._cachedPages.splice(0,1);u(n)})},t.prototype.resolveLayout=function(t,i){var f=this,u=this._cachedLayouts.filter(function(n){return n.name==t})[0],r;if(u!=null){i(u);return}if(r=n.layouts.find(t),r==null){i(null,new n.NotFoundException("Макет '{0}' не найден.".format(t)));return}new n.Layout(r,function(n,t){if(t!=null){i(null,t);return}f._cachedLayouts.push(n);i(n)})},t.prototype.activatePage=function(n,t){var i=this;this._activePage!=null&&(this._activePage.hide(),this._activePage.detach(),this._activePageSubscriptions.forEach(function(n){n.dispose()}),this._activePageSubscriptions.length=0);this._activeLayout!=t&&(this._activeLayout!=null&&(this._activeLayout.hide(),this._activeLayout.detach()),this._activeLayout=t,this._activeLayout!=null&&(this._activeLayout.attach(document.body),this._activeLayout.show()));this._activePage=n;this._activeLayout==null?this._activePage.attach(document.body):t.attachPage(this._activePage);this._activePage.show();document.title=this._activePage.title();this._activePageSubscriptions.push(n.params.subscribe(function(t){i.onPageParamsChanged(n,t)}));this._activePageSubscriptions.push(n.title.subscribe(function(t){i.onPageParamsChanged(n,t)}))},t.prototype.onPageParamsChanged=function(t,i){t==this._activePage&&history.pushState(t.guid,t.title(),"/"+t.name+i==null?"":"?"+n.QueryStringSerializer.serialize(i))},t.prototype.onPageTitleChanged=function(n,t){n==this._activePage&&(document.title=t)},t.prototype.getPageUrl=function(t,i){return i==null?"/"+t:"/"+t+"?"+n.QueryStringSerializer.serialize(i)},t.prototype.removeTrailingSlashes=function(n){return isNullOrWhiteSpace(n)?n:(n.startsWith("/")&&(n=n.substr(1)),n.endsWith("/")&&(n=n.substr(0,n.length-1)),n)},t}();n.Application=t}(spa||(spa={})),function(n){function u(t,i,u){var f=n.dialogs.find(t);if(f==null)throw new n.Exception("Диалоговое окно '{0}' не найдено.".format(t));new r(f,i,function(n,t){if(t!=null)throw t;n.showModal(function(t){u!=null&&u(t);n.dispose()})})}var r=function(){function r(t,i,r){var u=this;this._subscriptions=[];this.zIndex=0;this.close=this.close.bind(this);window.addEventListener("resize",this.updateLocation);this.resolveTemplate(t,function(f,e){if(e!=null){r(null,e);return}u._dialogHeaderElement=document.createElement("div");u._dialogHeaderElement.classList.add("dialog-header");u._dialogBodyElement=document.createElement("div");u._dialogBodyElement.classList.add("dialog-body");u._dialogBodyElement.innerHTML=f;u._dialogElement=document.createElement("div");u._dialogElement.classList.add("dialog");u._dialogElement.classList.add("dialog-hidden");u._dialogElement.appendChild(u._dialogHeaderElement);u._dialogElement.appendChild(u._dialogBodyElement);u.resolveViewModel(t,i,function(i,f){if(f!=null){r(null,f);return}if(u._viewModel=i,"close"in u._viewModel){r(null,new n.Exception("Метод '{0}' не может быть переопределен в диалоговом окне '{1}'.".format("close",t.name)));return}if(u._viewModel.close=function(n){u.close(n)},u._viewModel.dialogSize==null&&(u._viewModel.dialogSize=ko.observable(t.size)),t.size==null&&u._viewModel.dialogSize({height:480,width:640}),u._subscriptions.push(u._viewModel.dialogSize.subscribe(function(n){u.updateSize(n)})),u._viewModel.dialogTitle==null&&(u._viewModel.dialogTitle=ko.observable(t.title)),u._dialogHeaderElement.innerHTML=u._viewModel.dialogTitle(),u._subscriptions.push(u._viewModel.dialogTitle.subscribe(function(n){u.updateTitle(n)})),u._viewModel!=null){try{ko.applyBindings(u._viewModel,u._dialogBodyElement)}catch(e){var o="Произошла ошибка при создании диалогового окна {0}. ".format(t.name);e==null?r(null,new n.Exception(o)):r(null,new n.Exception(o+e.toString()));return}r(u)}})})}return r.prototype.show=function(n){this.display(!1,n)},r.prototype.showModal=function(n){this.display(!0,n)},r.prototype.updateLocation=function(){var n=this._viewModel.dialogSize(),t=this.getAbsoluteSize(n.height,window.innerHeight),i=this.getAbsoluteSize(n.width,window.innerWidth);this._dialogElement.style.left=(window.innerWidth/2-i/2).toString()+"px";this._dialogElement.style.top=(window.innerHeight/2-t/2).toString()+"px"},r.prototype.updateSize=function(n){this._dialogElement.style.height=typeof n.height=="number"?n.height+"px":n.height.toString();this._dialogElement.style.width=typeof n.width=="number"?n.width+"px":n.width.toString()},r.prototype.updateTitle=function(n){this._dialogHeaderElement.innerHTML=n},r.prototype.getAbsoluteSize=function(n,t){if(typeof n=="number")return n;var i=n.toString();return i.contains("%")?parseInt(i)*t/100:parseInt(i)},r.prototype.resolveTemplate=function(t,i){if(isNullOrWhiteSpace(t.template)){var u=t.templateUrl.toLowerCase();u in r.templates?i(r.templates[u]):n.Http.getAsync(t.templateUrl).then(function(n){r.templates[u]=n;i(n)},function(n){i(null,n)})}else i(t.template)},r.prototype.resolveViewModel=function(t,i,r){var o,u,s,e;if(t.viewModel==null){r(null);return}if(o=n.getFunctionParameterNames(t.viewModel).length>1,u="Произошла ошибка при создании диалогового окна {0}. ".format(t.name),o)try{s=new t.viewModel(i,function(t){setTimeout(function(){t==null?r(s):r(null,new n.Exception(u+t.toString()))},0)})}catch(f){f==null?r(null,new n.Exception(u)):r(null,new n.Exception(u+f.toString()));return}else{e=null;try{e=new t.viewModel(i)}catch(f){f==null?r(null,new n.Exception(u)):r(null,new n.Exception(u+f.toString()));return}r(e)}},r.prototype.display=function(n,r){var u=this;this.updateLocation();this.updateSize(this._viewModel.dialogSize());this.zIndex=1e3;i.forEach(function(n){u.zIndex=Math.max(u.zIndex,n.zIndex+2)});this._dialogElement.style.zIndex=this.zIndex.toString();n&&(t==null&&(t=document.createElement("div"),t.classList.add("dialog-overlay"),t.classList.add("dialog-overlay-hidden")),t.style.zIndex=(this.zIndex-1).toString(),t.parentElement==null&&document.body.appendChild(t),t.classList.contains("dialog-overlay-hidden")&&setTimeout(function(){t.classList.remove("dialog-overlay-hidden")},10));this._closeCallback=r;this._dialogElement.parentElement==null&&document.body.appendChild(this._dialogElement);setTimeout(function(){u._dialogElement.classList.remove("dialog-hidden")},10);i.push(this)},r.prototype.close=function(n){var r=this;this._dialogElement.classList.add("dialog-hidden");setTimeout(function(){document.body.removeChild(r._dialogElement);r._closeCallback!=null&&(r._closeCallback(n),r._closeCallback=null)},200);i.remove(this);t!=null&&(i.length==0?(t.classList.add("dialog-overlay-hidden"),setTimeout(function(){document.body.removeChild(t)},200)):t.style.zIndex=(i[i.length-1].zIndex-1).toString())},r.destroyAll=function(){while(i.length>0){var n=i.pop();n.dispose()}t!=null&&t.parentElement!=null&&t.parentElement!=null&&document.body.removeChild(t)},r.prototype.dispose=function(){this._viewModel!=null&&(ko.cleanNode(this._dialogBodyElement),this._viewModel.dispose!=null&&this._viewModel.dispose());this._dialogElement!=null&&(this._dialogElement.parentElement!=null&&document.body.removeChild(this._dialogElement),n.GC.disposeElement(this._dialogElement));this._dialogBodyElement=null;this._dialogElement=null;this._dialogHeaderElement=null;this._subscriptions.forEach(function(n){n.dispose()});this._subscriptions.length=0},r.templates={},r}(),t,i;n.Dialog=r;t=null;i=[];n.showDialog=u}(spa||(spa={})),function(n){var t=function(){function t(){this._items={}}return t.prototype.find=function(t){if(isNullOrWhiteSpace(t))throw new n.ArgumentNullException("name");return this._items[t.toLowerCase()]},t.prototype.register=function(t){if(t==null)throw new n.ArgumentNullException("config");if(isNullOrWhiteSpace(t.name))throw new n.ArgumentException("Не задано название диалогового окна.");if(isNullOrWhiteSpace(t.template)&&isNullOrWhiteSpace(t.templateUrl))throw new n.ArgumentException("Не задан шаблон диалогового окна {0}.".format(t.name));if(this._items[t.name.toLowerCase()]!=null)throw new n.Exception("Шаблон диалогового окна {0} уже зарегистрирован.".format(t.name));this._items[t.name.toLowerCase()]=t},t.prototype.remove=function(t){if(t==null)throw new n.ArgumentNullException("name");return t.toLowerCase()in this._items?(delete this._items[t.toLowerCase()],!0):!1},t}();n.DialogConfigurations=t}(spa||(spa={})),function(n){var t=function(){function t(){this._items={}}return t.prototype.find=function(t){if(isNullOrWhiteSpace(t))throw new n.ArgumentNullException("name");return this._items[t.toLowerCase()]},t.prototype.register=function(t){if(t==null)throw new n.ArgumentNullException("config");if(isNullOrWhiteSpace(t.name))throw new n.ArgumentException("Не задано название макета.");if(isNullOrWhiteSpace(t.template)&&isNullOrWhiteSpace(t.templateUrl))throw new n.ArgumentException("Не задан шаблон макета {0}.".format(t.name));if(isNullOrWhiteSpace(t.containerClass))throw new n.ArgumentException("Не задан класс контейнера макета {0}.".format(t.name));if(this._items[t.name.toLowerCase()]!=null)throw new n.Exception("Макет {0} уже зарегистрирован.".format(t.name));this._items[t.name.toLowerCase()]=t},t.prototype.remove=function(t){if(t==null)throw new n.ArgumentNullException("name");return t.toLowerCase()in this._items?(delete this._items[t.toLowerCase()],!0):!1},t}();n.LayoutConfigurations=t}(spa||(spa={})),function(n){var t=function(){function t(){this._items={}}return t.prototype.find=function(t){if(isNullOrWhiteSpace(t))throw new n.ArgumentNullException("name");return this._items[t.toLowerCase()]},t.prototype.register=function(t){if(t==null)throw new n.ArgumentNullException("config");if(isNullOrWhiteSpace(t.name))throw new n.ArgumentException("Не задано название страницы.");if(isNullOrWhiteSpace(t.template)&&isNullOrWhiteSpace(t.templateUrl))throw new n.ArgumentException("Не задан шаблон страницы {0}.".format(t.name));if(this._items[t.name.toLowerCase()]!=null)throw new n.Exception("Страница {0} уже зарегистрирована.".format(t.name));this._items[t.name.toLowerCase()]=t},t.prototype.remove=function(t){if(t==null)throw new n.ArgumentNullException("name");return t.toLowerCase()in this._items?(delete this._items[t.toLowerCase()],!0):!1},t}();n.PageConfigurations=t}(spa||(spa={})),function(n){n.dialogs=new n.DialogConfigurations;n.layouts=new n.LayoutConfigurations;n.pages=new n.PageConfigurations}(spa||(spa={})),function(n){var t=function(){function t(t,i){var r=this;this.name=t.name;this.resolveTemplate(t,function(u,f){if(f!=null){i(null,f);return}r._template=document.createElement("div");r._template.innerHTML=u;r._template.style.display="none";var e=r._template.getElementsByClassName(t.containerClass);if(e.length==0){i(null,new n.Exception("Макет {0} не содержит элемента-контейнера страниц класса {1}.".format(name,t.containerClass)));return}if(e.length>1){i(null,new n.Exception("Макет {0} содержит более одного элемента-контейнера страниц класса {1}.".format(name,t.containerClass)));return}r._container=e[0];r.resolveViewModel(t,function(u,f){if(f!=null){i(null,f);return}if(r._viewModel=u,r._viewModel!=null)try{ko.applyBindings(r._viewModel,r._template);i(r)}catch(e){e==null?i(null,new n.Exception("Произошла ошибка при создании страницы {0}.".format(t.name))):i(null,e instanceof n.Exception?e:new n.Exception(e.toString()))}})})}return Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t.prototype.resolveTemplate=function(i,r){isNullOrWhiteSpace(i.template)?i.templateUrl.toLowerCase()in t.templates?r(t.templates[i.templateUrl.toLowerCase()]):n.Http.getAsync(i.templateUrl).then(function(n){t.templates[i.templateUrl.toLowerCase()]=n;r(n)},function(n){r(null,n)}):r(i.template)},t.prototype.resolveViewModel=function(t,i){var u,f,e;if(t.viewModel==null){i(null);return}if(u=n.getFunctionParameterNames(t.viewModel).length>0,u)try{f=new t.viewModel(function(n){setTimeout(function(){n==null?i(f,null):i(null,n)},0)})}catch(r){r==null?i(null,new n.Exception("Произошла ошибка при создании макета {0}.".format(t.name))):i(null,r instanceof n.Exception?r:new n.Exception(r.toString()));return}else{try{e=new t.viewModel}catch(r){r==null?i(null,new n.Exception("Произошла ошибка при создании макета {0}.".format(t.name))):i(null,r instanceof n.Exception?r:new n.Exception(r.toString()));return}i(e,null)}},Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),t.prototype.attach=function(n){n.appendChild(this._template)},t.prototype.detach=function(){this._template.parentElement!=null&&this._template.parentElement.removeChild(this._template)},t.prototype.show=function(){this._template.style.display=""},t.prototype.hide=function(){this._template.style.display="none"},t.prototype.attachPage=function(n){n.attach(this._template)},t.prototype.detachPage=function(n){n.detach()},t.prototype.dispose=function(){this._viewModel!=null&&(ko.cleanNode(this._template),this._viewModel.dispose!=null&&this._viewModel.dispose());n.GC.disposeElement(this._template);this._container=null;this._template=null;this._viewModel=null},t.templates={},t}();n.Layout=t}(spa||(spa={})),function(n){var t=function(){function t(t,i,r){var u=this;this.params=ko.pureComputed(function(){return u._viewModel!=null&&u._viewModel.pageParams!=null?ko.unwrap(u._viewModel.pageParams):u._params});this.title=ko.pureComputed(function(){return u._viewModel!=null&&u._viewModel.pageTitle!=null?ko.unwrap(u._viewModel.pageTitle):u._config.title});this._config=t;this._guid=newGuid();this._name=t.name;this._params=i;this.resolveTemplate(t,function(f,e){if(e!=null){r(null,e);return}u.resolveViewModel(t,i,function(i,e){if(e!=null){r(null,e);return}if(u._template=document.createElement("span"),u._template.innerHTML=f,u._template.style.display="none",u._viewModel=i,u._viewModel!=null){try{ko.applyBindings(u._viewModel,u._template)}catch(o){o==null?r(null,new n.Exception("Произошла ошибка при создании страницы {0}.".format(t.name))):r(null,o instanceof n.Exception?o:new n.Exception(o.toString()));return}r(u)}})})}return Object.defineProperty(t.prototype,"guid",{get:function(){return this._guid},set:function(n){this._guid=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t.prototype.resolveTemplate=function(i,r){isNullOrWhiteSpace(i.template)?i.templateUrl.toLowerCase()in t.templates?r(t.templates[i.templateUrl.toLowerCase()]):n.Http.getAsync(i.templateUrl).then(function(n){t.templates[i.templateUrl.toLowerCase()]=n;r(n)},function(n){r(null,n)}):r(i.template)},t.prototype.resolveViewModel=function(t,i,r){var e,o,f;if(t.viewModel==null){r(null);return}if(e=n.getFunctionParameterNames(t.viewModel).length>1,e)try{o=new t.viewModel(i,function(n){setTimeout(function(){n==null?r(o):r(null,n)},0)})}catch(u){u==null?r(null,new n.Exception("Произошла ошибка при создании страницы {0}.".format(t.name))):r(null,u instanceof n.Exception?u:new n.Exception(u.toString()));return}else{f=null;try{f=new t.viewModel(i)}catch(u){u==null?r(null,new n.Exception("Произошла ошибка при создании страницы {0}.".format(t.name))):r(null,u instanceof n.Exception?u:new n.Exception(u.toString()));return}r(f)}},t.prototype.show=function(){this._template.style.display="";this._viewModel!=null&&this._viewModel.onPageEnter!=null&&this._viewModel.onPageEnter()},t.prototype.hide=function(){this._template.style.display="none";this._viewModel!=null&&this._viewModel.onPageLeave!=null&&this._viewModel.onPageLeave()},t.prototype.attach=function(n){n.appendChild(this._template)},t.prototype.detach=function(){this._template.parentElement!=null&&this._template.parentElement.removeChild(this._template)},t.prototype.canLeave=function(){return this._viewModel!=null&&this._viewModel.onPageLeaving!=null?this._viewModel.onPageLeaving():!0},t.prototype.dispose=function(){this._viewModel!=null&&(ko.cleanNode(this._template),this._viewModel.dispose!=null&&this._viewModel.dispose());n.GC.disposeElement(this._template);this._template=null;this._viewModel=null},t.templates={},t}();n.Page=t}(spa||(spa={})),function(n){var t=function(){function n(){this._started=!1}return n.prototype.start=function(){this._started=!0;this.onRouteChanged()},n.prototype.stop=function(){this._started=!1},n.prototype.registerPages=function(){},n.prototype.route=function(){},n.prototype.routeMissing=function(){},n.prototype.changed=function(){},n.prototype.onRouteChanged=function(){history.state==null&&history.replaceState(newGuid(),document.title,location.pathname+location.search)},n}();n.Router=t}(spa||(spa={})),function(n){var t=function(){function t(){this._disposed=!1;this._template=document.createElement("div");this._template.style.display="none"}return Object.defineProperty(t.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0}),t.prototype.load=function(i,r){var f=this,u=i.toLowerCase();u in t.loadedTemplates?this.loadHtml(t.loadedTemplates[u]):n.Http.getAsync(i).then(function(n){t.loadedTemplates[u]=n;f.loadHtml(n);r()},function(n){r(n)})},t.prototype.loadHtml=function(n){ko.cleanNode(this._template);this._template.innerHTML=n;ko.applyBindings(this,this._template)},t.prototype.dispose=function(){this._disposed||(ko.cleanNode(this._template),n.GC.disposeElement(this._template),this._disposed=!0,this._template=null)},t.loadedTemplates={},t}();n.View=t}(spa||(spa={})),function(n){var t=function(){function n(){this.text=ko.observable("");this.okClick=this.okClick.bind(this)}return n.prototype.close=function(){},n.prototype.okClick=function(){this.close(this.text())},n.dialogName="InputString",n}();n.dialogs.register({name:t.dialogName,template:"<input data-bind='textInput: text' /><button data-bind='click: okClick'>ОК<\/button>",title:"Ввод строки",viewModel:t,size:{height:300,width:400}})}(spa||(spa={})),function(n){var t=function(){function n(){}return n.createFileInput=function(n,t){var i=document.createElement("input");return i.setAttribute("type","file"),i.style.left="-200px",i.style.top="-200px",i.style.width="0",i.style.height="0",i.style.overflow="hidden",i.style.position="absolute",t&&i.setAttribute("accept",t),n&&i.setAttribute("multiple","multiple"),document.body.appendChild(i),i},n.show=function(t,i,r){i===void 0&&(i=!1);r===void 0&&(r="");var u=n.createFileInput(i,r);u.onchange=function(){var i,n;if(t&&u.files&&u.files.length>0){for(i=[],n=0;n<u.files.length;n++)i.push(u.files[n]);t(i)}document.body.removeChild(u)};u.click()},n}();n.OpenFileDialog=t}(spa||(spa={})),function(n){var t=function(){function n(n){this.errorMessage=ko.observable();n==null||n.exception==null?this.errorMessage("Ресурс не найден."):this.errorMessage(n.exception.toString())}return n.pageName="Forbidden",n}();n.ForbiddenPage=t;n.pages.register({name:t.pageName,template:'<div data-bind="text: errorMessage"><\/div>',title:"Доступ запрещен",viewModel:t})}(spa||(spa={})),function(n){var t=function(){function n(n){this.errorMessage=ko.observable();n==null||n.exception==null?this.errorMessage("Ресурс не найден."):this.errorMessage(n.exception.toString())}return n.pageName="InternalServerError",n}();n.InternalServerErrorPage=t;n.pages.register({name:t.pageName,template:'<div data-bind="text: errorMessage"><\/div>',title:"Ошибка приложения",viewModel:t})}(spa||(spa={})),function(n){var t=function(){function n(n){this.errorMessage=ko.observable();n==null||n.exception==null?this.errorMessage("Ресурс не найден."):this.errorMessage(n.exception.toString())}return n.pageName="NotFound",n}();n.NotFoundPage=t;n.pages.register({name:t.pageName,template:'<div data-bind="text: errorMessage"><\/div>',title:"Ресурс не найден",viewModel:t})}(spa||(spa={}));